<article
  class="lms-course-card card"
  [class.lms-course-card--owned]="owned"
  (click)="toggleReveal()"
>
  <div class="card-inner" [class.is-revealed]="isRevealed">
    <div class="card-front">
      <div class="head_card">
        <h3 class="lms-course-card__title">{{ course.title }}</h3>
        <div class="lms-course-card__thumb">
          <ng-container *ngIf="getThumbnailUrl() as thumbnailUrl; else thumbFallback">
            <img [src]="thumbnailUrl" [alt]="course.title ?? 'Course thumbnail'" loading="lazy" />
          </ng-container>
          <ng-template #thumbFallback>
            <div class="lms-course-card__thumb-placeholder" aria-hidden="true">üéì</div>
          </ng-template>
        </div>
      </div>
      <div class="lms-course-card__meta">
        <div class="lms-course-card__meta-item">
          <span class="lms-course-card__meta-label">Rating</span>

          <span class="lms-course-card__meta-value"
            >‚≠ê {{ getRating() | number : '1.1-1' }} / 5</span
          >
        </div>

        <div class="lms-course-card__meta-item" *ngIf="course.category">
          <span class="lms-course-card__meta-label">Category</span>

          <span class="lms-course-card__meta-value">{{ course.category }}</span>
        </div>

        <div class="lms-course-card__meta-item" *ngIf="course.pathTitle">
          <span class="lms-course-card__meta-label">Path</span>

          <span class="lms-course-card__meta-value">{{ course.pathTitle }}</span>
        </div>

        <div
          class="lms-course-card__meta-item"
          *ngIf="course.hours !== null && course.hours !== undefined"
        >
          <span class="lms-course-card__meta-label">Duration</span>

          <span class="lms-course-card__meta-value">{{ course.hours }} hours</span>
        </div>
      </div>

      <footer class="lms-course-card__footer">
        <div class="lms-course-card__price">
          <span class="lms-course-card__price-label">Price</span>

          <div class="lms-course-card__price-values">
            <span
              class="lms-course-card__price-value"
              [class.lms-course-card__price-value--strikethrough]="hasDiscount()"
            >
              {{ getBasePrice() | number : '1.2-2' }} $
            </span>

            <span
              class="lms-course-card__price-value lms-course-card__price-value--final"
              *ngIf="hasDiscount()"
            >
              {{ getFinalPrice() | number : '1.2-2' }} $
            </span>
          </div>

          <span class="lms-course-card__price-discount" *ngIf="hasDiscount()">
            Save {{ getDiscountPercent() | number : '1.0-0' }}%
          </span>
        </div>

        <button
          type="button"
          class="lms-primary-btn"
          (click)="onPurchase(); $event.stopPropagation()"
          [disabled]="isProcessing"
        >
          {{ owned ? 'View' : isProcessing ? 'Processing...' : 'Buy' }}
        </button>
      </footer>
    </div>

    <div class="card-back" *ngIf="getDescription() as description">
      <p class="lms-course-card__description">{{ description }}</p>
    </div>
  </div>
</article>
