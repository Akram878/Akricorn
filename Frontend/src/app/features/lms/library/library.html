<div class="lms-section">
  <div class="lms-section__header">
    <div class="lms-section__breadcrumb">
      <span>LMS</span>
      <span>/</span>
      <span class="active">Library</span>
    </div>

    <h2>Digital Library</h2>
    <p>Explore a selection of digital books available in the library.</p>
  </div>
  <div class="lms-section__body">
    <app-lms-filters
      [filters]="filters"
      [state]="filterState"
      [resultCount]="filteredBooks.length"
      (stateChange)="applyFilters($event)"
      (reset)="resetFilters()"
    ></app-lms-filters>

    <div class="lms-section__content">
      <div class="lms-library-grid" *ngIf="!isLoading && !error && filteredBooks.length > 0">
        <app-book-card
          *ngFor="let b of filteredBooks; trackBy: trackByBookId"
          [book]="b"
          [coverUrl]="bookThumbnails[b.id]"
          [owned]="isBookOwned(b)"
          [isProcessing]="processingBookId === b.id"
          (view)="onView(b)"
          (buy)="onBuy(b)"
        ></app-book-card>
      </div>

      <div class="lms-section__state" *ngIf="!isLoading && error">
        {{ error }}
      </div>

      <div class="lms-section__state" *ngIf="!isLoading && !error && filteredBooks.length === 0">
        No books match the selected filters yet.
      </div>

      <div class="lms-section__state" *ngIf="isLoading">Loading books...</div>
    </div>
  </div>
</div>
